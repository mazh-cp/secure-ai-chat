@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Shared Brand Colors (same in both modes) */
  --accent-primary: 142, 97, 240; /* #8E61F0 */
  --accent-secondary: 78, 69, 146; /* #4E4592 */
  
  /* Dark Mode Default Values */
  --bg-primary: 20, 28, 44; /* #141C2C */
  --bg-secondary: 29, 40, 57; /* #1D2839 */
  --bg-tertiary: 50, 60, 78; /* #323C4E */
  --text-primary: 240, 237, 244; /* #F0EDF4 */
  --text-secondary: 137, 143, 153; /* #898F99 */
  --border-default: 89, 99, 113; /* #596371 */
  
  /* Legacy compatibility - mapped to new palette */
  --foreground-rgb: var(--text-primary);
  --background-start-rgb: var(--bg-primary);
  --background-end-rgb: var(--bg-secondary);
  --brand-berry: var(--accent-primary);
  --brand-berry-rgb: rgb(var(--accent-primary));
  --brand-berry-light: var(--accent-primary);
  --brand-berry-dark: var(--accent-secondary);
  
  /* Success/Secure Notice Design Tokens */
  --success-bg: rgba(34, 197, 94, 0.1);
  --success-border: rgba(34, 197, 94, 0.3);
  --success-text: #4ade80;
  --radius-md: 0.5rem;
  --space-4: 1rem;
  --space-6: 1.5rem;
  --gap-2: 0.5rem;
}

* {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

html,
body {
  height: 100%;
  max-width: 100vw;
  overflow-x: hidden;
}

/* Dark Mode - Explicitly set dark mode values */
html.dark {
  color-scheme: dark;
  /* Dark Mode Color Tokens */
  --bg-primary: 20, 28, 44; /* #141C2C */
  --bg-secondary: 29, 40, 57; /* #1D2839 */
  --bg-tertiary: 50, 60, 78; /* #323C4E */
  --text-primary: 240, 237, 244; /* #F0EDF4 */
  --text-secondary: 137, 143, 153; /* #898F99 */
  --border-default: 89, 99, 113; /* #596371 */
  /* Legacy compatibility */
  --brand-berry: var(--accent-primary);
  --brand-berry-rgb: rgb(var(--accent-primary));
  --brand-berry-light: var(--accent-primary);
  --brand-berry-dark: var(--accent-secondary);
  --foreground-rgb: var(--text-primary);
  --background-start-rgb: var(--bg-primary);
  --background-end-rgb: var(--bg-secondary);
}

html.dark body {
  color: rgb(var(--text-primary, 240, 237, 244));
  background: linear-gradient(135deg, rgb(var(--bg-primary, 20, 28, 44)) 0%, rgb(var(--bg-secondary, 29, 40, 57)) 25%, rgb(var(--bg-tertiary, 50, 60, 78)) 50%, rgb(var(--bg-secondary, 29, 40, 57)) 75%, rgb(var(--bg-primary, 20, 28, 44)) 100%);
  background-size: 400% 400%;
  animation: gradientShift 15s ease infinite;
  min-height: 100vh;
}

/* Light Mode - Override with light mode values */
html.light {
  color-scheme: light;
  /* Light Mode Color Tokens */
  --bg-primary: 246, 247, 251; /* #F6F7FB */
  --bg-secondary: 255, 255, 255; /* #FFFFFF */
  --bg-tertiary: 238, 241, 247; /* #EEF1F7 */
  --text-primary: 15, 23, 42; /* #0F172A */
  --text-secondary: 71, 85, 105; /* #475569 */
  --border-default: 203, 213, 225; /* #CBD5E1 */
  /* Legacy compatibility */
  --brand-berry: var(--accent-primary);
  --brand-berry-rgb: rgb(var(--accent-primary));
  --brand-berry-light: var(--accent-primary);
  --brand-berry-dark: var(--accent-secondary);
  --foreground-rgb: var(--text-primary);
  --background-start-rgb: var(--bg-primary);
  --background-end-rgb: var(--bg-secondary);
}

/* Light Mode Background */
html.light body {
  color: rgb(var(--text-primary, 15, 23, 42));
  background: linear-gradient(135deg, rgb(var(--bg-primary, 246, 247, 251)) 0%, rgb(var(--bg-secondary, 255, 255, 255)) 25%, rgb(var(--bg-tertiary, 238, 241, 247)) 50%, rgb(var(--bg-secondary, 255, 255, 255)) 75%, rgb(var(--bg-primary, 246, 247, 251)) 100%);
  background-size: 400% 400%;
  animation: gradientShift 15s ease infinite;
  min-height: 100vh;
}

@keyframes gradientShift {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

/* Bento Grid Layout System */
@layer utilities {
  .bento-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    padding: 1.5rem;
  }

  @media (min-width: 768px) {
    .bento-grid {
      grid-template-columns: repeat(4, 1fr);
      grid-auto-rows: minmax(200px, auto);
    }
  }

  .bento-card {
    position: relative;
    overflow: hidden;
    border-radius: 1.5rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
  }

  .bento-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 40px rgba(var(--accent-primary), 0.3);
  }

  /* Bento Card Sizes */
  .bento-span-1 {
    grid-column: span 1;
    grid-row: span 1;
  }

  .bento-span-2 {
    grid-column: span 2;
  }

  .bento-span-3 {
    grid-column: span 3;
  }

  .bento-span-4 {
    grid-column: span 4;
  }

  .bento-row-span-1 {
    grid-row: span 1;
  }

  .bento-row-span-2 {
    grid-row: span 2;
  }

  .bento-row-span-3 {
    grid-row: span 3;
  }

  @media (max-width: 768px) {
    .bento-span-2,
    .bento-span-3,
    .bento-span-4 {
      grid-column: span 1;
    }
  }

  /* Glassmorphism Base Styles */
  /* Dark Mode Glass */
  .glass {
    background: rgba(var(--bg-secondary), 0.3);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid rgba(var(--border-default), 0.3);
    box-shadow: 0 8px 32px 0 rgba(var(--accent-primary), 0.2);
  }

  html.light .glass {
    background: rgba(var(--bg-secondary), 0.4);
    border: 1px solid rgba(var(--border-default), 0.4);
    box-shadow: 0 8px 32px 0 rgba(var(--accent-primary), 0.15);
  }

  .glass-dark {
    background: rgba(var(--bg-tertiary), 0.3);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid rgba(var(--border-default), 0.2);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
  }

  html.light .glass-dark {
    background: rgba(var(--bg-tertiary), 0.3);
    border: 1px solid rgba(var(--border-default), 0.3);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
  }

  .glass-card {
    background: rgba(var(--bg-secondary), 0.15);
    backdrop-filter: blur(25px) saturate(200%);
    -webkit-backdrop-filter: blur(25px) saturate(200%);
    border: 1px solid rgba(var(--border-default), 0.4);
    box-shadow: 
      0 8px 32px 0 rgba(var(--accent-primary), 0.25),
      inset 0 1px 0 rgba(var(--accent-primary), 0.3);
  }

  html.light .glass-card {
    background: rgba(var(--bg-secondary), 0.6);
    border: 1px solid rgba(var(--border-default), 0.5);
    box-shadow: 
      0 8px 32px 0 rgba(var(--accent-primary), 0.15),
      inset 0 1px 0 rgba(var(--text-primary), 0.8);
  }

  .glass-button {
    background: rgba(var(--accent-primary), 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(var(--accent-primary), 0.4);
    box-shadow: 
      0 4px 16px 0 rgba(var(--accent-primary), 0.2),
      inset 0 1px 0 rgba(var(--accent-primary), 0.3);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  html.light .glass-button {
    background: rgba(var(--accent-primary), 0.3);
    border: 1px solid rgba(var(--accent-primary), 0.5);
    box-shadow: 
      0 4px 16px 0 rgba(var(--accent-primary), 0.15),
      inset 0 1px 0 rgba(var(--text-primary), 0.7);
  }

  .glass-button:hover {
    background: rgba(var(--accent-primary), 0.3);
    transform: translateY(-2px);
    border-color: rgba(var(--accent-primary), 0.6);
    box-shadow: 
      0 8px 24px 0 rgba(var(--accent-primary), 0.3),
      inset 0 1px 0 rgba(var(--accent-primary), 0.5);
  }

  html.light .glass-button:hover {
    background: rgba(var(--accent-primary), 0.4);
    border-color: rgba(var(--accent-primary), 0.7);
    box-shadow: 
      0 8px 24px 0 rgba(var(--accent-primary), 0.2),
      inset 0 1px 0 rgba(var(--text-primary), 0.9);
  }

  .glass-input {
    background: rgba(var(--bg-secondary), 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(var(--border-default), 0.3);
    box-shadow: 
      0 4px 16px 0 rgba(var(--accent-primary), 0.1),
      inset 0 1px 0 rgba(var(--accent-primary), 0.2);
  }

  html.light .glass-input {
    background: rgba(var(--bg-secondary), 0.6);
    border: 1px solid rgba(var(--border-default), 0.4);
    box-shadow: 
      0 4px 16px 0 rgba(var(--accent-primary), 0.08),
      inset 0 1px 0 rgba(var(--text-primary), 0.8);
  }

  .glass-input:focus {
    background: rgba(var(--bg-secondary), 0.2);
    border-color: rgba(var(--accent-primary), 0.6);
    box-shadow: 
      0 4px 16px 0 rgba(var(--accent-primary), 0.2),
      inset 0 1px 0 rgba(var(--accent-primary), 0.4),
      0 0 0 3px rgba(var(--accent-primary), 0.2);
  }

  html.light .glass-input:focus {
    background: rgba(var(--bg-secondary), 0.8);
    border-color: rgba(var(--accent-primary), 0.6);
    box-shadow: 
      0 4px 16px 0 rgba(var(--accent-primary), 0.15),
      inset 0 1px 0 rgba(var(--text-primary), 1),
      0 0 0 3px rgba(var(--accent-primary), 0.2);
  }

  .liquid-shimmer {
    position: relative;
    overflow: hidden;
  }

  .liquid-shimmer::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(var(--accent-primary), 0.3),
      transparent
    );
    animation: shimmer 3s infinite;
  }

  html.light .liquid-shimmer::before {
    background: linear-gradient(
      90deg,
      transparent,
      rgba(var(--accent-primary), 0.4),
      transparent
    );
  }

  .text-balance {
    text-wrap: balance;
  }

  /* Theme-aware text colors with safe fallbacks */
  .text-theme {
    color: rgb(var(--text-primary, 240, 237, 244));
  }

  html.light .text-theme {
    color: rgb(var(--text-primary, 15, 23, 42));
  }

  .text-theme-muted {
    color: rgba(var(--text-primary, 240, 237, 244), 0.7);
  }

  html.light .text-theme-muted {
    color: rgba(var(--text-primary, 15, 23, 42), 0.7);
  }

  .text-theme-subtle {
    color: rgba(var(--text-secondary, 137, 143, 153), 0.8);
  }

  html.light .text-theme-subtle {
    color: rgba(var(--text-secondary, 71, 85, 105), 0.8);
  }

  /* Override text-white in light mode for better readability */
  html.light .text-white {
    color: rgb(var(--text-primary)) !important;
  }

  /* Override text-white with opacity variants in light mode */
  html.light [class*="text-white/"] {
    color: rgba(var(--text-primary), 0.7) !important;
  }

  html.light [class*="text-white/60"] {
    color: rgba(var(--text-primary), 0.6) !important;
  }

  html.light [class*="text-white/70"] {
    color: rgba(var(--text-primary), 0.7) !important;
  }

  html.light [class*="text-white/50"] {
    color: rgba(var(--text-primary), 0.5) !important;
  }

  html.light [class*="text-white/40"] {
    color: rgba(var(--text-primary), 0.4) !important;
  }

  /* Override dark/black text colors in dark mode for better readability */
  html.dark .text-gray-900,
  html.dark .text-black {
    color: rgb(var(--text-primary)) !important;
  }

  html.dark .text-gray-800 {
    color: rgba(var(--text-primary), 0.95) !important;
  }

  html.dark .text-gray-700 {
    color: rgba(var(--text-primary), 0.9) !important;
  }

  html.dark .text-gray-600 {
    color: rgba(var(--text-primary), 0.8) !important;
  }

  html.dark .text-gray-500 {
    color: rgba(var(--text-secondary), 0.9) !important;
  }

  html.dark .text-gray-400 {
    color: rgba(var(--text-secondary), 0.8) !important;
  }

  html.dark .text-gray-300 {
    color: rgba(var(--text-secondary), 0.7) !important;
  }

  html.dark .text-slate-900,
  html.dark .text-slate-800,
  html.dark .text-slate-700,
  html.dark .text-slate-600 {
    color: rgba(var(--text-primary), 0.9) !important;
  }

  html.dark .text-zinc-900,
  html.dark .text-zinc-800,
  html.dark .text-zinc-700,
  html.dark .text-zinc-600 {
    color: rgba(var(--text-primary), 0.9) !important;
  }

  html.dark .text-neutral-900,
  html.dark .text-neutral-800,
  html.dark .text-neutral-700,
  html.dark .text-neutral-600 {
    color: rgba(var(--text-primary), 0.9) !important;
  }

  /* Ensure input placeholders are readable in light mode */
  html.light .glass-input::placeholder {
    color: rgba(var(--text-secondary), 0.8) !important;
  }

  html.light input::placeholder,
  html.light textarea::placeholder {
    color: rgba(var(--text-secondary), 0.8) !important;
  }

  /* Brand accent colors */
  .text-brand-accent {
    color: rgb(var(--accent-primary));
  }

  html.light .text-brand-accent {
    color: rgb(var(--accent-primary));
  }

  .border-brand-accent {
    border-color: rgba(var(--border-default), 0.5);
  }

  html.light .border-brand-accent {
    border-color: rgba(var(--border-default), 0.5);
  }

  /* Override brand-berry color classes to use CSS variable in dark mode */
  html.dark .text-brand-berry {
    color: var(--brand-berry-rgb) !important;
  }

  html.dark .bg-brand-berry {
    background-color: var(--brand-berry-rgb) !important;
  }

  html.dark .border-brand-berry {
    border-color: var(--brand-berry-rgb) !important;
  }

  html.dark .ring-brand-berry {
    --tw-ring-color: var(--brand-berry-rgb) !important;
  }

  /* Handle brand-berry opacity variants in dark mode */
  html.dark [class*="bg-brand-berry/"],
  html.dark [class*="border-brand-berry/"],
  html.dark [class*="text-brand-berry/"] {
    --tw-text-opacity: 1;
    --tw-bg-opacity: 1;
    --tw-border-opacity: 1;
  }

  /* Specific opacity variants */
  html.dark .bg-brand-berry\/30 {
    background-color: rgba(var(--brand-berry), 0.3) !important;
  }

  html.dark .bg-brand-berry\/50 {
    background-color: rgba(var(--brand-berry), 0.5) !important;
  }

  html.dark .bg-brand-berry\/20 {
    background-color: rgba(var(--brand-berry), 0.2) !important;
  }

  html.dark .border-brand-berry\/30 {
    border-color: rgba(var(--brand-berry), 0.3) !important;
  }

  html.dark .border-brand-berry\/50 {
    border-color: rgba(var(--brand-berry), 0.5) !important;
  }

  html.dark .ring-brand-berry\/30 {
    --tw-ring-color: rgba(var(--brand-berry), 0.3) !important;
  }

  /* Floating animation */
  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  .float {
    animation: float 3s ease-in-out infinite;
  }

  /* Pulse glow */
  @keyframes pulseGlow {
    0%, 100% {
      box-shadow: 0 0 20px rgba(var(--accent-primary), 0.4);
    }
    50% {
      box-shadow: 0 0 30px rgba(var(--accent-primary), 0.6);
    }
  }

  html.light .pulse-glow {
    animation: pulseGlowLight 2s ease-in-out infinite;
  }

  @keyframes pulseGlowLight {
    0%, 100% {
      box-shadow: 0 0 20px rgba(var(--accent-primary), 0.4);
    }
    50% {
      box-shadow: 0 0 30px rgba(var(--accent-primary), 0.6);
    }
  }

  .pulse-glow {
    animation: pulseGlow 2s ease-in-out infinite;
  }
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: rgba(var(--bg-tertiary), 0.1);
  backdrop-filter: blur(10px);
  border-radius: 10px;
}

html.light ::-webkit-scrollbar-track {
  background: rgba(var(--bg-tertiary), 0.05);
}

::-webkit-scrollbar-thumb {
  background: rgba(var(--border-default), 0.4);
  backdrop-filter: blur(10px);
  border-radius: 10px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

html.light ::-webkit-scrollbar-thumb {
  background: rgba(var(--border-default), 0.3);
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(var(--accent-primary), 0.6);
}

html.light ::-webkit-scrollbar-thumb:hover {
  background: rgba(var(--accent-primary), 0.5);
}

/* Selection styling */
::selection {
  background: rgba(var(--accent-primary), 0.3);
  color: rgb(var(--text-primary));
}

html.light ::selection {
  background: rgba(var(--accent-primary), 0.3);
  color: rgb(var(--text-primary));
}

::-moz-selection {
  background: rgba(var(--accent-primary), 0.3);
  color: rgb(var(--text-primary));
}

html.light ::-moz-selection {
  background: rgba(var(--accent-primary), 0.3);
  color: rgb(var(--text-primary));
}

/* Success/Secure Notice Block Styles */
.notice-success {
  background: var(--success-bg);
  border: 1px solid var(--success-border);
  color: var(--success-text);
  padding: var(--space-4);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-6);
  display: flex;
  align-items: center;
  gap: var(--gap-2);
}

:root[data-theme="day"] {
  --bg: #F8F9FB;
  --surface: #FFFFFF;
  --surface-alt: #F3F4F6;
  --header: #F1F2F4;
  --border: #E5E7EB;

  --text: #1F2937;
  --text-muted: #6B7280;

  --primary: #8B5CF6;
  --primary-hover: #A78BFA;

  --safe: #22C55E;
  --flagged: #EF4444;

  --card-shadow: 0 1px 2px rgba(16,24,40,0.06), 0 2px 8px rgba(16,24,40,0.06);
  --chip-text: #1F2937;
  
  --destructive-bg: transparent;
}

:root[data-theme="dark"] {
  --bg: #0F172A;
  --surface: #1E293B;
  --surface-alt: #243447;
  --header: #334155;
  --border: #3B475A;

  --text: #E5E7EB;
  --text-muted: #94A3B8;
  --text-faint: #64748B;

  --primary: #8B5CF6;
  --primary-hover: #A78BFA;

  --safe: #22C55E;
  --flagged: #EF4444;

  --card-shadow: none;
  --chip-text: #E5E7EB;

  --input-bg: #1F2937;
  --input-border: #374151;
  
  --destructive-bg: #7F1D1D;
}

